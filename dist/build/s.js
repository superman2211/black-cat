"use strict";(()=>{var A=Math,Ht=A.floor,lt=A.ceil,M=A.round,xt=A.min,_t=A.max,Pt=A.hypot,dt=A.abs,G=A.random,Ia=A.atan2,To=A.PI,Ta=To*2,At=Number.MAX_VALUE,et=(t,e,o)=>xt(e,_t(t,o)),Eo=(t,e,o)=>t+o*(e-t),Y=(t,e)=>Eo(t,e,G()),kt=t=>G()<t;function gt(t){return t[M(Y(0,t.length-1))]}function vt(t,e){let o=e.reduce((r,i)=>r+i,0),n=G()*o,a=0;for(let r=0;r<t.length;r++)if(a+=e[r],n<a)return t[r];return t[0]}var St=document,te="ontouchstart"in window;var Ro="canvas",_=t=>t.getContext("2d"),J=()=>St.createElement(Ro),ee=()=>_(J()),Ct=t=>t.canvas;var oe=(t,e)=>Ct(t).width=e,ne=(t,e)=>Ct(t).height=e;var z=(t,e,o,n)=>t.drawImage(e,M(o),M(n));var ht=()=>performance.now(),ae=t=>JSON.parse(JSON.stringify(t));async function re(t){return new Promise(e=>{setTimeout(e,t)})}var ie=t=>{let e=t>>24&255,o=t>>16&255,n=t>>8&255,a=t&255;return`rgba(${o}, ${n}, ${a}, ${e/255})`},se=(t,e,o,n,a,r,i)=>{let m=t.createLinearGradient(e,o,n,a);return m.addColorStop(0,ie(r)),m.addColorStop(1,ie(i)),m};var ce=(t,e,o,n)=>{let a=J(),r=_(a),i=d[o[0]];a.width=t,a.height=e;let m=lt(t/i.width),s=lt(e/i.height);for(let c=0;c<m;c++)for(let f=0;f<s;f++)i=d[vt(o,n)],r.drawImage(i,c*i.width,f*i.height);return a},fe=(t,e,o)=>{let n=J(),a=_(n);n.width=t,n.height=e;let r=d[o],i=lt(t/r.width),m=lt(e/r.height);for(let s=0;s<i;s++)for(let c=0;c<m;c++)a.drawImage(r,s*r.width,c*r.height);return n},pe=(t,e)=>{for(let o=0;o<t.length;o+=3){let n=t[o],a=t[o+1],r=t[o+2],i=d[n];z(e,i,a,r)}},Mt=(t,e,o,n,a,r,i)=>{t.fillStyle=se(t,e,o,e,o+a,r,i),t.fillRect(e,o,n,a)};var zt=(t,e)=>{let o=_(t),n=t.width,a=t.height,r=o.getImageData(0,0,n,a),i=r.data,m=0;for(;m<i.length;){let s=i.slice(m,m+4);e(s),i.set(s,m),m+=4}o.putImageData(r,0,0)},It=t=>{var e=J(),o=_(e);return e.width=t.width,e.height=t.height,o.drawImage(t,0,0),e};var le=(t,e,o)=>{zt(t,n=>{let a=Bo(n),r=e.indexOf(a);if(r!=-1){let i=o[r];Wo(i,n)}})},me=new Uint32Array(1),Bo=t=>{let e=t[0],o=t[1],n=t[2],a=t[3];return me[0]=a<<24|e<<16|o<<8|n,me[0]},Wo=(t,e)=>{let o=t>>24&255,n=t>>16&255,a=t>>8&255,r=t&255;e[0]=n,e[1]=a,e[2]=r,e[3]=o};var d=[],Dt={},ut=t=>{let e=d.length;return d.push(t),e},ot=(t,e)=>{let o=`${t}_${e}`;if(!Dt[o]){let n=e>>24&255,a=e>>16&255,r=e>>8&255,i=e&255,m=It(d[t]);zt(m,s=>{s[0]=a,s[1]=r,s[2]=i,s[3]&&(s[3]=n)}),Dt[o]=ut(m)}return Dt[o]},Ft=(t,e)=>{let o=_(e),n=t/2,a=o.getImageData(0,0,e.width,e.height),r=a.data,i=0;for(;i<r.length;){let m=r[i],s=r[i+1],c=r[i+2];r[i]=m-n+t*G(),r[i+1]=s-n+t*G(),r[i+2]=c-n+t*G(),i+=4}o.putImageData(a,0,0)};var xe=[[[.6,0,100,,,.2,1,.5,,-10,,,,3,,,,10],[.7,0,110,,,.2,2,.1,,,,,,,,,,,.1,.4],[1.3,0,300,,,0,4,3,,,300,,,1,,,,.3,.2],[,0,,,.13,.7,2,.2,,,,,.04,.3,,.02,1,,.3,.1],[3,0,60,,,,3,.2,,,,.5,,.6,1,.05],[,0],[,0]],[[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,3,,15,,3,,15,,],[3,.3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,1,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,4,,16,16,4,,16,16,4,,16,,4,,16,16,4,,16,16,4,,16,16,3,,15,15,3,,15,15],[3,.4,,,,,20,,,,,,23,,,,,,25,,,,,,27,,,,,,25,,,,27,,,,,,,,,,,,,,,,28,,27,,,,25,,,,27,,,,25,,]]],[0,0,1,1],,];var de=(...t)=>Ot(ge(...t)),Ot=(...t)=>{let e=E.createBufferSource(),o=E.createBuffer(t.length,t[0].length,v);return t.map((n,a)=>o.getChannelData(a).set(n)),e.buffer=o,e},ge=(t=1,e=.05,o=220,n=0,a=0,r=.1,i=0,m=1,s=0,c=0,f=0,p=0,u=0,H=0,P=0,O=0,b=0,$=1,q=0,st=0)=>{let w=2*Math.PI,mt=s*=500*w/v**2,ct=(0<P?1:-1)*w/4,Z=o*=(1+2*e*Math.random()-e)*w/v,j=[],T=0,ft=0,x=0,U=1,Wt=0,Io=0,V=0,pt,tt;for(n=99+v*n,q*=v,a*=v,r*=v,b*=v,c*=500*w/v**3,P*=w/v,f*=w/v,p*=v,u=v*u|0,tt=n+q+a+r+b|0;x<tt;j[x++]=V)++Io%(100*O|0)||(V=i?1<i?2<i?3<i?Math.sin((T%w)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/w%2+2)%2:1-4*Math.abs(Math.round(T/w)-T/w):Math.sin(T),V=(u?1-st+st*Math.sin(2*Math.PI*x/u):1)*(0<V?1:-1)*Math.abs(V)**m*t*Ho*(x<n?x/n:x<n+q?1-(x-n)/q*(1-$):x<n+q+a?$:x<tt-b?(tt-x-b)/r*$:0),V=b?V/2+(b>x?0:(x<tt-b?1:(tt-x)/b)*j[x-b|0]/2):V),pt=(o+=s+=c)*Math.sin(ft*P-ct),T+=pt-pt*H*(1-1e9*(Math.sin(x)+1)%2),ft+=pt-pt*H*(1-1e9*(Math.sin(x)**2+1)%2),U&&++U>p&&(o+=f,Z+=f,U=0),!u||++Wt%u||(o=Z,s=mt,U=U||1);return j},Ho=.3,v=44100,E=new(window.AudioContext||webkitAudioContext),he=(t,e,o,n=125)=>{let a,r,i,m,s,c,f,p,u,H,P,O,b,$,q=0,st,w=[],mt=[],ct=[],Z=0,j=0,T=1,ft={},x=44100/n*60>>2;for(;T;Z++)w=[T=p=P=b=0],o.map((U,Wt)=>{for(f=e[U][Z]||[0,0,0],T|=!!e[U][Z],st=b+(e[U][0].length-2-!p)*x,$=Wt==o.length-1,r=2,m=b;r<f.length+$;p=++r){for(s=f[r],u=r==f.length+$-1&&$||H!=(f[0]||0)|s|0,i=0;i<x&&p;i++>x-99&&u?O+=(O<1)/99:0)c=(1-O)*w[q++]/2||0,mt[m]=(mt[m]||0)-c*j+c,ct[m]=(ct[m++]||0)+c*j+c;s&&(O=s%1,j=f[1]||0,(s|=0)&&(w=ft[[H=f[q=0]||0,s]]=ft[[H,s]]||(a=[...t[H]],a[2]=(a[2]||220)*2**((s-12)/12),s>0?ge(...a):[])))}b=st});return[mt,ct]};var R=E.createGain(),D=E.createGain();R.gain.value=.2;D.gain.value=.6;var Po=[,,418,.01,.01,.03,4,2.1,-1,,,,,.2,,.2,,.67,.03,,107],Ao=[,1,48,,.04,.01,4,1.6,1,-26,300,,,1.3,,.1,,.9,.03];var Tt=(t=!1)=>{(t||E.state==="suspended")&&E.resume().catch()},ue=async()=>{let t=await zo(xe),e=Ot(...t);e.connect(R),e.loop=!0,e.start(),R.gain.value=.5,R.connect(E.destination),E.resume()},zo=async t=>(await re(50),he(...t)),ye=t=>{let e=de(...t);e.connect(D),e.loop=!1,D.connect(E.destination),e.start()};var be=()=>ye(Po),we=()=>ye(Ao);var N;(function(t){t.normalize=e=>{let o=t.length(e);o>0&&(e.x/=o,e.y/=o)},t.length=e=>Pt(e.x,e.y),t.distance=(e,o)=>Pt(e.x-o.x,e.y-o.y),t.add=(e,o)=>({x:e.x+o.x,y:e.y+o.y}),t.subtract=(e,o)=>({x:e.x-o.x,y:e.y-o.y}),t.scale=(e,o)=>({x:e.x*o,y:e.y*o})})(N||(N={}));var yt=ht(),I=0,_e=()=>{let t=yt;yt=ht(),I=(yt-t)/1e3};var nt=t=>{let e=0;for(let o of t)e+=o.time;return e},Et=(t,e)=>{let o=0,n=nt(t);e%=n;for(let a=0;a<t.length;a++){let r=t[a];if(o+=r.time,e<=o)return r.image}return 0},bt=(t,e)=>{let o=nt(t);return e>=o};var at=[],ke={animation:[{image:63,time:.1},{image:64,time:.1},{image:65,time:.1}],offset:{x:16,y:16}},ve={animation:[{image:66,time:.1},{image:67,time:.2},{image:68,time:.2}],offset:{x:8,y:8}},Se={animation:[{image:69,time:.1},{image:70,time:.2},{image:71,time:.2}],offset:{x:8,y:8}},Vo=t=>{let e=at.indexOf(t);e!=-1&&at.splice(e,1)},Ce=(t,e)=>{at.push({animation:t.animation,animationTime:0,sprite:{image:0,x:e.x-t.offset.x,y:e.y-t.offset.y}})},Me=()=>{for(let t of at){let e=nt(t.animation);t.animationTime+=I,t.animationTime>e?Vo(t):t.sprite.image=Et(t.animation,t.animationTime)}};var B=[],Ie=t=>{let e=B.indexOf(t);e!=-1&&B.splice(e,1)},Te=()=>{B.splice(0,B.length)};var Ut,C=()=>Ut,Ee=t=>{Ut=t;for(let e of Ut.items)e.sprite.x=e.position.x-e.offset.x,e.sprite.y=e.position.y-e.offset.y,e.shadow&&(e.shadow.x=e.position.x-e.offset.x,e.shadow.y=e.position.y-e.offset.y*e.shadow.scaleY),B.push(e)},Re=()=>{let t=C(),e=d[t.back.image];-t.camera.x>0&&(t.camera.x=0),-t.camera.x+e.width<S&&(t.camera.x=e.width-S),-t.camera.y>0&&(t.camera.y=0),-t.camera.y+e.height<W&&(t.camera.y=e.height-W)};var g=[],Rt=t=>{let e={config:t,state:0,controller:{move:{x:0,y:0},hand:!1,leg:!1,cross:!1},health:t.health,direction:1,position:{x:0,y:0},speed:{x:0,y:0},animationTime:0,sprite:{image:0},shadow:{image:0},damage:0,frame:0};return g.push(e),B.push(e),e},Yo=t=>{let e=g.indexOf(t);e!=-1&&g.splice(e,1),Ie(t)},We=()=>{g.splice(0,g.length)},He=()=>{let t=C();for(let e of g.values())e.position.x=et(t.bounds.x,t.bounds.x+t.bounds.w,e.position.x),e.position.y=et(t.bounds.y,t.bounds.y+t.bounds.h,e.position.y)},Pe=()=>{for(let t of g.values())Lo(t)},Lo=t=>{let e=null,o=t.config,n=o.animations;switch(t.state){case 0:e=n.stand,(t.controller.move.x!=0||t.controller.move.y!=0)&&(t.state=1,t.animationTime=0),Be(t);break;case 1:t.controller.move.x==0&&t.controller.move.y==0?(t.state=0,t.animationTime=0):dt(t.controller.move.x)>dt(t.controller.move.y)?e=n.walkH:e=n.walkV,N.normalize(t.controller.move),t.position.x+=t.controller.move.x*o.walkSpeed*I,t.position.y+=t.controller.move.y*o.walkSpeed*I,Be(t);break;case 2:e=n.jab,bt(e,t.animationTime)&&(t.controller.hand?t.state=3:t.state=0,t.animationTime=0);break;case 3:e=n.cross,bt(e,t.animationTime)&&(t.controller.hand||(t.state=0,t.animationTime=0));break;case 4:e=n.kick,bt(e,t.animationTime)&&(t.state=0,t.animationTime=0);break;case 5:e=t.animation||n.damage1,bt(e,t.animationTime)&&(t.state=0,t.animationTime=0,t.animation=void 0);break;case 6:e=t.animation||n.dead1,nt(e)<=t.animationTime+I&&(Yo(t),e=null);break}t.position.x+=t.speed.x*I,t.position.y+=t.speed.y*I,t.speed.x*=.9,t.speed.y*=.9,t.controller.move.x>0?t.direction=1:t.controller.move.x<0&&(t.direction=-1),e&&(t.animationTime+=I,t.sprite.image=Et(e,t.animationTime),t.sprite.flipX=t.direction<0,t.shadow.image=ot(t.sprite.image,1426063360),t.shadow.flipX=t.sprite.flipX),t.damage=0,t.frame!=t.sprite.image&&(t.frame=t.sprite.image,t.damage=o.damages[t.frame]||0)},Ae=()=>{for(let t of g){if(t.health<=0||!t.damage)continue;let e=null,o=At,n=At;for(let a of g)if(!(a.health<=0)&&t.config.mob!=a.config.mob){let r=a.position.x-t.position.x;if(r*t.direction>0){let i=dt(r),m=dt(t.position.y-a.position.y);i<25&&m<10&&(!e||o>i||n>m)&&(e=a,o=i,n=m)}}if(e){e.health-=t.damage,e.speed.x+=t.direction*t.damage/100*300,t.speed.x+=t.direction*10;let a=t.damage>=20?(we(),ke):(be(),kt(.5)?Se:ve);Ce(a,N.add(e.position,{x:Y(-3,3),y:Y(-14,-18)})),e.health>0?(e.state=5,e.animation!=e.config.animations.knockdown&&(e.animationTime=0),e.animation=gt([e.config.animations.damage1,e.config.animations.damage2,e.config.animations.knockdown])):(e.state=6,e.animation=gt([e.config.animations.dead1,e.config.animations.dead2]),e.animationTime=0)}}},ze=()=>{for(let t of g.values())Ko(t)},Ko=t=>{let e=t.config;t.sprite.x=t.position.x-e.offset.x,t.sprite.y=t.position.y-e.offset.y,t.shadow.scaleY=.4,t.shadow.x=t.position.x-e.offset.x+0,t.shadow.y=t.position.y-e.offset.y*t.shadow.scaleY},Be=t=>{t.controller.leg&&(t.state=4,t.animationTime=0),t.controller.hand&&(t.state=2,t.animationTime=0),t.controller.cross&&(t.state=3,t.animationTime=0)};var An=()=>{let t=[];return t[33]=61,t[35]=0,t[46]=62,t[47]=-1,t.push(25,26,27,28,29,30,31,32,33,34),t[64]=0,t.push(35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60),t},Gt=An(),De=t=>{if(t!=32&&(Gt[t]===void 0||Gt[t]===-1))throw`symbol not found ${t} char ${String.fromCharCode(t)}`;return Gt[t]};var X=(t,e)=>{t.save();let o=d[e.image],n=1,a=0,r=0,i=e.scaleY||1,m=M(e.x||0),s=M(e.y||0);e.flipX&&(n=-1,m+=o.width),e.flipY&&(i=-1,s+=o.height),t.transform(n,a,r,i,m,s),z(t,o,0,0),t.restore()},Fe=(t,e)=>{for(let o of e)X(t,o)};var y=document.getElementById("c");y.style.imageRendering="pixelated";var l=_(y),S=200,W=200,L={x:0,y:0},Oe=()=>{let t=window.innerWidth,e=window.innerHeight,o=xt(t/S,e/W);y.width=_t(S,t/o),y.height=_t(W,e/o),y.style.width=`${t}px`,y.style.height=`${e}px`,L.x=Ht((y.width-S)/2),L.y=Ht((y.height-W)/2)},Ue=()=>{l.clearRect(0,0,y.width,y.height),l.setTransform(1,0,0,1,L.x,L.y);let t=C();l.save(),l.translate(M(-t.camera.x),M(-t.camera.y)),X(l,t.back),l.shadowBlur=2,l.shadowColor="black";for(let e of g)X(l,e.shadow);for(let e of t.items)e.shadow&&X(l,e.shadow);l.shadowBlur=0,B.sort((e,o)=>e.position.y==o.position.y?o.position.x-e.position.x:e.position.y-o.position.y);for(let e of B)X(l,e.sprite);for(let e of at)X(l,e.sprite);l.restore(),l.fillStyle="black",y.width<y.height?(l.fillRect(0,-L.y,S,L.y),l.fillRect(0,W,S,W)):(l.fillRect(-L.x,0,L.x,S),l.fillRect(S,0,S,W)),zn()},zn=()=>{if(!0){l.shadowBlur=3,l.shadowColor="black";let t=(ht()-yt).toFixed(),e=(1/I).toFixed();Nt(3,3,`FPS ${e} TIME ${t}`,4294967295);let o=M(R.gain.value*100),n=M(D.gain.value*100);Nt(3,19,`MUSIC ${o}`,4278255615),Nt(3,35,`EFFECT ${n}`,4294902015),l.shadowBlur=0}},Nt=(t,e,o,n)=>{for(let a=0;a<o.length;a++){let r=o[a].toUpperCase().charCodeAt(0),i=De(r);if(i!==void 0){let m=ot(i,n),s=d[m];s!==void 0&&z(l,s,t+a*8,e)}}};var Xt={},Ge=!1,Ne=()=>{St.onkeydown=t=>{Tt(),Ge=!0,Xt[t.keyCode]=!0,t.preventDefault()},St.onkeyup=t=>{Ge=!1,Dn(t.keyCode),t.preventDefault()},y.onmousedown=()=>{Tt()},y.ontouchstart=()=>{Tt()}},h=t=>Xt[t],Dn=t=>delete Xt[t];var Xn={mob:!1,health:1e3,walkSpeed:30,offset:{x:16,y:29},animations:{stand:[{image:72,time:.2},{image:73,time:.2},{image:74,time:.2},{image:73,time:.2},{image:72,time:.2},{image:75,time:.2}],walkH:[{image:72,time:.1},{image:76,time:.1},{image:77,time:.1},{image:76,time:.1}],walkV:[{image:83,time:.1},{image:84,time:.1},{image:83,time:.1},{image:85,time:.1}],jab:[{image:72,time:.05},{image:80,time:.1}],cross:[{image:80,time:.1},{image:81,time:.1},{image:82,time:.1},{image:81,time:.1}],kick:[{image:72,time:.05},{image:78,time:.05},{image:79,time:.1},{image:78,time:.1}],damage1:[{image:72,time:1}],damage2:[{image:72,time:1}],knockdown:[{image:72,time:1}],dead1:[{image:72,time:1}],dead2:[{image:72,time:1}]},damages:{80:10,82:20,79:30}},k,je=()=>{k=Rt(Xn)},rt=()=>k,Je=()=>{k&&(k.health<=0||(k.controller.move.x=0,k.controller.move.y=0,k.controller.leg=!1,k.controller.hand=!1,(h(37)||h(65))&&(k.controller.move.x=-1),(h(39)||h(68))&&(k.controller.move.x=1),(h(38)||h(87))&&(k.controller.move.y=-1),(h(40)||h(83))&&(k.controller.move.y=1),h(90)&&(k.controller.leg=!0),h(88)&&(k.controller.hand=!0)))};var Yr=1*(Math.exp(.5)-1);var Qe,Ze=[];te||$n();function $n(){Qe||(Qe=new AudioContext,console.log("sound inited"))}async function to(){let e=await(await fetch("r")).arrayBuffer(),o=new Uint8Array(e),n=0,a=o[n++]*4,r=o.slice(n,n+a);n+=a;let i=o[n++];for(;i--;){let s=o[n++],c=o[n++],f=s*c,p=o.slice(n,n+f);n+=f;let u=ee();oe(u,s),ne(u,c);let H=u.getImageData(0,0,s,c);for(let P=0;P<p.length;P++){let O=p[P]<<2;H.data.set(r.slice(O,O+4),P<<2)}u.putImageData(H,0,0),d.push(Ct(u))}let m=o[n++];for(;m--;){let s=o[n++];Ze.push(e.slice(n,n+s)),n+=s}}var so=()=>{let n=sa(400,150),a=ma(400,95),r=J(),i=_(r);r.width=400,r.height=245,z(i,a,0,0),z(i,n,0,95);let m=ut(r),s=10,c=5,f=[];for(let p=0;p<10;p++)Vt(f,90+p*21,120);Vt(f,84,114),Vt(f,273,114);for(let p=0;p<10;p++)ra(f,100+p*20,130);for(let p=0;p<6;p++)ia(f,80+p*45,240);return{bounds:{x:s,y:95+c,w:400-s*2,h:150-c*2},back:{image:m},camera:{x:0,y:0},items:f}},Vt=(t,e,o)=>{t.push({sprite:{image:6},position:{x:e,y:o},offset:{x:16,y:32},bounds:{x:-16,y:-10,w:32,h:12}})},ra=(t,e,o)=>{t.push({sprite:{image:7},position:{x:e,y:o},offset:{x:16,y:32},bounds:{x:-6,y:-7,w:12,h:10},shadow:{image:ot(7,1426063360),scaleY:.4}})},ia=(t,e,o)=>{t.push({sprite:{image:0},position:{x:e,y:o},offset:{x:32,y:64},bounds:{x:-34,y:-22,w:68,h:25}})},sa=(t,e)=>{let o=ce(t,e,[2,3,4,5],[3,2,1,1]),n=_(o),a=30;return n.fillStyle="black",n.fillRect(0,0,o.width,1),Mt(n,0,0,o.width,a,1996488704,0),Mt(n,0,o.height-a,o.width,a,0,1996488704),Ft(10,o),o},ma=(t,e)=>{let o=fe(t,e,8),n=_(o),a=[9,10,11],r=[2,1,1],i=70;for(let s=0;s<t;s+=i)for(let c=0;c<t;c+=16){let f=d[vt(a,r)];z(n,f,s,c)}pe([12,i-13,0,12,i*3-13,0,12,i*6-13,0,13,i*2-17,0,13,i*5-30,0],n),Lt(n,89,30),Lt(n,159,30),Lt(n,229,30);let m=40;return Mt(n,0,o.height-m,o.width,m,0,1996488704),Ft(10,o),o},Yt=(t,e,o,n)=>{for(let a=0;a<6;a++){let r=gt(e);X(t,{image:r,x:a*7+o,y:n})}};function Lt(t,e,o){t.setTransform(1,0,0,1,e,o),Fe(t,[{image:14},{image:15,y:16},{image:14,y:32,flipY:!0},{image:16,x:16},{image:14,x:32,flipX:!0},{image:15,x:32,y:16,flipX:!0},{image:14,x:32,y:32,flipY:!0,flipX:!0},{image:17,x:16,y:16},{image:16,x:16,y:32,flipY:!0},{image:18,x:3,y:15},{image:18,x:16,y:15},{image:18,x:29,y:15},{image:18,x:3,y:30},{image:18,x:16,y:30},{image:18,x:29,y:30}]),Yt(t,[19,20,21],-1,-1),Yt(t,[21,22,20],-1,14),Yt(t,[23],-1,28),t.resetTransform()}var mo=()=>{We(),Te(),Ee(so()),je();let t=C(),e=rt();e.position.x=t.bounds.x+250,e.position.y=t.bounds.y+t.bounds.h/2};var co=()=>{let t=C(),e=rt();t.camera.x=e.position.x-S/2,t.camera.y=e.position.y-W/2};var wt=[],ba=[4278190080,4294939392,4287898002,4289362242,4284354049,4290735454,4278215936,4278217323,4278261885],wa={mob:!0,health:100,walkSpeed:20,offset:{x:16,y:31},animations:{stand:[{image:87,time:.3},{image:88,time:.3},{image:87,time:.3},{image:89,time:.3},{image:90,time:.3},{image:89,time:.3}],walkH:[{image:87,time:.2},{image:91,time:.2},{image:87,time:.2},{image:92,time:.2}],walkV:[{image:87,time:.2},{image:96,time:.2},{image:87,time:.2},{image:97,time:.2}],jab:[{image:87,time:.2},{image:93,time:.2}],cross:[{image:93,time:.2},{image:94,time:.2},{image:95,time:.2},{image:94,time:.2}],kick:[{image:87,time:.2},{image:98,time:.2},{image:99,time:.2},{image:98,time:.2}],damage1:[{image:101,time:.5},{image:100,time:.3}],damage2:[{image:105,time:.5},{image:104,time:.3}],knockdown:[{image:100,time:.2},{image:101,time:.5},{image:102,time:1},{image:103,time:.3},{image:104,time:.2}],dead1:[{image:105,time:.2},{image:106,time:.2},{image:107,time:.2},{image:108,time:5}],dead2:[{image:100,time:.2},{image:101,time:.5},{image:102,time:1}]},damages:{93:5,95:10,99:20}},Zt=[],_o=()=>{Zt.push(bo([4278190080,4294939392,4281545523,4281545523,4288256409,4294939392,4278190131,4278190131,4278190080],"bob")),Zt.push(bo([4278190080,4294939392,4285642965,4294939392,4294939392,4278190080,4286151563,4286151563,4278190080],"jack"))},bo=(t,e)=>{let o=ae(wa);o.walkSpeed=Y(10,20);let n=o.animations;for(let a in n){let r=n[a];_a(r,ba,t,e)}return o},_a=(t,e,o,n)=>{for(let a of t)a.image=ka(a.image,e,o,n)},Qt={},ka=(t,e,o,n)=>{let a=`${t}_${n}`;if(!Qt[a]){let r=It(d[t]);le(r,e,o),Qt[a]=ut(r)}return Qt[a]},wo=t=>{let e=Rt(Zt[t]);return wt.push(e),e};var va=t=>{let e=wt.indexOf(t);e!=-1&&wt.splice(e,1)},ko=()=>{let t=rt();for(let e of wt)Sa(e,t)},Sa=(t,e)=>{if(g.indexOf(t)==-1&&va(t),t.health<=0)return;t.controller.move.x=0,t.controller.move.y=0,t.controller.leg=!1,t.controller.hand=!1,t.controller.cross=!1;let o=15;if(t.state==0||t.state==1){let n=N.subtract(e.position,t.position);if(N.length(n)>o)N.normalize(n),t.controller.move.x=n.x,t.controller.move.y=n.y;else{t.controller.move.x=0,t.controller.move.y=0;let r=G();r<.5?t.controller.hand=!0:r<.8?t.controller.cross=!0:t.controller.leg=!0}}},vo=()=>{if(wt.length<2){let t=C(),e=kt(.5)?wo(0):wo(1);e.position.x=t.bounds.x+100+Y(-40,40),e.position.y=t.bounds.y+t.bounds.h/2+Y(-40,40)}};var So=()=>{let t=C();for(let e of g)for(let o of t.items){let n=o.position.x+o.bounds.x,a=o.position.y+o.bounds.y,r=n+o.bounds.w,i=a+o.bounds.h,m=e.position.x-n,s=e.position.y-a,c=r-e.position.x,f=i-e.position.y;if(m>0&&s>0&&c>0&&f>0){let p=xt(m,s,c,f);m==p&&(e.position.x-=m),s==p&&(e.position.y-=s),c==p&&(e.position.x+=c),f==p&&(e.position.y+=f)}}};var Co=()=>{h(85)&&(R.gain.value-=.01),h(73)&&(R.gain.value+=.01),R.gain.value=et(0,1,R.gain.value),h(74)&&(D.gain.value-=.01),h(75)&&(D.gain.value+=.01),D.gain.value=et(0,1,D.gain.value)};console.warn("debug mode"),new EventSource("/esbuild").addEventListener("change",()=>location.reload());var Mo=()=>{_e(),Oe(),vo(),Je(),ko(),Pe(),So(),Ae(),He(),Me(),co(),Re(),ze(),Ue(),Co(),requestAnimationFrame(Mo)};async function Ca(){await to(),ue(),Ne(),_o(),mo(),Mo()}Ca();})();
//# sourceMappingURL=s.js.map

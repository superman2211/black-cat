"use strict";(()=>{var S=Math,Fe=S.floor,R=S.round,st=S.min,tt=S.max,qe=S.hypot,Ue=S.abs,Ne=S.random,Ge=S.atan2,Dt=S.PI,He=Dt*2;var W=document,at="ontouchstart"in window;var Ot="canvas",et=t=>t.getContext("2d"),Ft=()=>W.createElement(Ot),it=()=>et(Ft()),K=t=>t.canvas;var ct=(t,e)=>K(t).width=e,ft=(t,e)=>K(t).height=e;var ot=(t,e,o,n)=>t.drawImage(e,R(o),R(n));var H=()=>performance.now();async function pt(t){return new Promise(e=>{setTimeout(e,t)})}var L=H(),B=0,mt=()=>{let t=L;L=H(),B=(L-t)/1e3};var lt=t=>{let e=0;for(let o of t)e+=o.time;return e},ut=(t,e)=>{let o=0,n=lt(t);e%=n;for(let r=0;r<t.length;r++){let i=t[r];if(o+=i.time,e<=o)return i.image}return 0},dt=(t,e)=>{let o=lt(t);return e>=o};var $=[],xt=t=>{let e={config:t,state:0,controller:{move:{x:0,y:0},hand:!1,leg:!1},health:0,position:{x:0,y:0},animationTime:0,image:0};return $.push(e),e};var ht=()=>{for(let t of $.values()){let e=null,o=t.config,n=o.animations;switch(t.state){case 0:e=n.stand,t.controller.move.x!=0&&(t.state=1,t.animationTime=0),t.controller.leg&&(t.state=4,t.animationTime=0);break;case 1:e=n.walk,t.controller.move.x==0&&(t.state=0,t.animationTime=0);break;case 2:e=n.jab;break;case 3:e=n.cross;break;case 4:e=n.kick,dt(e,t.animationTime)&&(t.state=0,t.animationTime=0);break}t.position.x+=t.controller.move.x*o.walkSpeed*B,e&&(t.animationTime+=B,t.image=ut(e,t.animationTime))}};var Me=()=>{let t=[];return t[33]=36,t[35]=0,t[46]=37,t[47]=-1,t.push(0,1,2,3,4,5,6,7,8,9),t[64]=0,t.push(10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35),t},nt=Me(),gt=t=>{if(!1)throw`symbol not found ${t} char ${String.fromCharCode(t)}`;return nt[t]};var V=[];var u=document.getElementById("c");u.style.imageRendering="pixelated";var D=et(u),j=200,J=200,X={x:0,y:0},_t=()=>{let t=window.innerWidth,e=window.innerHeight,o=st(t/j,e/J);u.width=tt(j,t/o),u.height=tt(J,e/o),u.style.width=`${t}px`,u.style.height=`${e}px`,X.x=R((u.width-j)/2),X.y=R((u.height-J)/2)},wt=()=>{D.clearRect(0,0,u.width,u.height),D.setTransform(1,0,0,1,X.x,X.y),D.fillStyle="gray",D.fillRect(0,0,j,J);for(let t of $.values()){let e=V[t.image];ot(D,e,t.position.x,t.position.y)}Se()},Se=()=>{if(!1){let t=(H()-L).toFixed(),e=(1/B).toFixed();be(3,3,`FPS ${e} TIME ${t}`,16777215)}},be=(t,e,o,n)=>{for(let r=0;r<o.length;r++){let i=o[r].toUpperCase().charCodeAt(0),l=gt(i);if(l!==void 0){let x=V[l];x!==void 0&&ot(D,x,t+r*8,e)}}};var yt=(...t)=>{let e=C.createBufferSource(),o=C.createBuffer(t.length,t[0].length,d);return t.map((n,r)=>o.getChannelData(r).set(n)),e.buffer=o,e.connect(C.destination),e.start(),e},ke=(t=1,e=.05,o=220,n=0,r=0,i=.1,l=0,x=1,s=0,h=0,f=0,_=0,c=0,w=0,y=0,v=0,p=0,b=1,k=0,F=0)=>{let m=2*Math.PI,q=s*=500*m/d**2,U=(0<y?1:-1)*m/4,T=o*=(1+2*e*Math.random()-e)*m/d,z=[],g=0,N=0,a=0,M=1,Y=0,Bt=0,I=0,G,P;for(n=99+d*n,k*=d,r*=d,i*=d,p*=d,h*=500*m/d**3,y*=m/d,f*=m/d,_*=d,c=d*c|0,P=n+k+r+i+p|0;a<P;z[a++]=I)++Bt%(100*v|0)||(I=l?1<l?2<l?3<l?Math.sin((g%m)**3):Math.max(Math.min(Math.tan(g),1),-1):1-(2*g/m%2+2)%2:1-4*Math.abs(Math.round(g/m)-g/m):Math.sin(g),I=(c?1-F+F*Math.sin(2*Math.PI*a/c):1)*(0<I?1:-1)*Math.abs(I)**x*t*Ie*(a<n?a/n:a<n+k?1-(a-n)/k*(1-b):a<n+k+r?b:a<P-p?(P-a-p)/i*b:0),I=p?I/2+(p>a?0:(a<P-p?1:(P-a)/p)*z[a-p|0]/2):I),G=(o+=s+=h)*Math.sin(N*y-U),g+=G-G*w*(1-1e9*(Math.sin(a)+1)%2),N+=G-G*w*(1-1e9*(Math.sin(a)**2+1)%2),M&&++M>_&&(o+=f,T+=f,M=0),!c||++Y%c||(o=T,s=q,M=M||1);return z},Ie=.3,d=44100,C=new(window.AudioContext||webkitAudioContext),vt=(t,e,o,n=125)=>{let r,i,l,x,s,h,f,_,c,w,y,v,p,b,k,F=0,m=[],q=[],U=[],T=0,z=0,g=1,N={},a=44100/n*60>>2;for(;g;T++)m=[g=_=y=p=0],o.map((M,Y)=>{for(f=e[M][T]||[0,0,0],g|=!!e[M][T],k=p+(e[M][0].length-2-!_)*a,b=Y==o.length-1,i=2,x=p;i<f.length+b;_=++i){for(s=f[i],c=i==f.length+b-1&&b||w!=(f[0]||0)|s|0,l=0;l<a&&_;l++>a-99&&c?v+=(v<1)/99:0)h=(1-v)*m[F++]/2||0,q[x]=(q[x]||0)-h*z+h,U[x]=(U[x++]||0)+h*z+h;s&&(v=s%1,z=f[1]||0,(s|=0)&&(m=N[[w=f[F=0]||0,s]]=N[[w,s]]||(r=[...t[w]],r[2]*=2**((s-12)/12),s>0?ke(...r):[])))}p=k});return[q,U]};var Q=(t=!1)=>{(t||C.state==="suspended")&&C.resume().catch()},Mt=async t=>{let e=await Ce(t),o=yt(...e);o.loop=!0,C.resume()},Ce=async t=>(await pt(50),vt(...t));var rt={},St=!1,bt=()=>{W.onkeydown=t=>{Q(),St=!0,rt[t.keyCode]=!0,t.preventDefault()},W.onkeyup=t=>{St=!1,ze(t.keyCode),t.preventDefault()},u.onmousedown=()=>{Q()},u.ontouchstart=()=>{Q()}},O=t=>rt[t],ze=t=>delete rt[t];var Re={walkSpeed:30,animations:{stand:[{image:38,time:.2},{image:39,time:.2},{image:40,time:.2},{image:39,time:.2},{image:38,time:.2},{image:41,time:.2}],walk:[{image:38,time:.1},{image:42,time:.1},{image:43,time:.1},{image:42,time:.1}],jab:[],cross:[],kick:[{image:38,time:.1},{image:44,time:.1},{image:45,time:.1},{image:44,time:.1}]}},E=xt(Re);E.position.y=100;E.position.x=100;var zt=()=>{E.controller.move.x=0,E.controller.leg=!1,(O(37)||O(65))&&(E.controller.move.x=-1),(O(39)||O(68))&&(E.controller.move.x=1),O(38)&&(E.controller.leg=!0)};var bo=1*(Math.exp(.5)-1);var At,Et=[];at||Be();function Be(){At||(At=new AudioContext,!1)}async function Tt(){let e=await(await fetch("r")).arrayBuffer(),o=new Uint8Array(e),n=0,r=o[n++]*4,i=o.slice(n,n+r);n+=r;let l=o[n++];for(;l--;){let s=o[n++],h=o[n++],f=s*h,_=o.slice(n,n+f);n+=f;let c=it();ct(c,s),ft(c,h);let w=c.getImageData(0,0,s,h);for(let y=0;y<_.length;y++){let v=_[y]<<2;w.data.set(i.slice(v,v+4),y<<2)}c.putImageData(w,0,0),V.push(K(c))}let x=o[n++];for(;x--;){let s=o[n++];Et.push(e.slice(n,n+s)),n+=s}}var Pt=[[[.6,0,100,,,.2,1,.5,,-10,,,,3,,,,10],[.7,0,110,,,.2,2,.1,,,,,,,,,,,.1,.4],[1.3,0,300,,,0,4,3,,,300,,,1,,,,.3,.2],[,0,,,.13,.7,2,.2,,,,,.04,.3,,.02,1,,.3,.1],[3,0,60,,,,3,.2,,,,.5,,.6,1,.05],[,0],[,0]],[[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,3,,15,,3,,15,,],[3,.3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,1,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,4,,16,16,4,,16,16,4,,16,,4,,16,16,4,,16,16,4,,16,16,3,,15,15,3,,15,15],[3,.4,,,,,20,,,,,,23,,,,,,25,,,,,,27,,,,,,25,,,,27,,,,,,,,,,,,,,,,28,,27,,,,25,,,,27,,,,25,,]]],[1,0,1,0],,{title:"dbc_8bit",authorUrl:"https://www.youtube.com/@dbcoll",author:"DBColl",instruments:["BD","Bass","Snare","Korg Filter","Bass Drum","Instrument 5","Instrument 6"],patterns:["Pattern 0","Pattern 1"]}];!1;var Rt=()=>{mt(),_t(),zt(),ht(),wt(),requestAnimationFrame(Rt)};async function De(){await Tt(),Mt(Pt),bt(),Rt()}De();})();
//# sourceMappingURL=s.js.map

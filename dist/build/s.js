"use strict";(()=>{var P=Math,Et=P.floor,ct=P.ceil,B=P.round,ft=P.min,ut=P.max,Rt=P.hypot,pt=P.abs,F=P.random,ga=P.atan2,yo=P.PI,ha=yo*2,Wt=Number.MAX_VALUE,Pt=(t,e,o)=>ft(e,ut(t,o)),bo=(t,e,o)=>t+o*(e-t),Q=(t,e)=>bo(t,e,F()),Bt=t=>F()<t;function lt(t){return t[B(Q(0,t.length-1))]}function yt(t,e){let o=e.reduce((r,i)=>r+i,0),n=F()*o,a=0;for(let r=0;r<t.length;r++)if(a+=e[r],n<a)return t[r];return t[0]}var bt=document,Jt="ontouchstart"in window;var wo="canvas",w=t=>t.getContext("2d"),V=()=>bt.createElement(wo),Qt=()=>w(V()),wt=t=>t.canvas;var Zt=(t,e)=>wt(t).width=e,te=(t,e)=>wt(t).height=e;var H=(t,e,o,n)=>t.drawImage(e,B(o),B(n));var xt=()=>performance.now(),ee=t=>JSON.parse(JSON.stringify(t));async function oe(t){return new Promise(e=>{setTimeout(e,t)})}var ne=t=>{let e=t>>24&255,o=t>>16&255,n=t>>8&255,a=t&255;return`rgba(${o}, ${n}, ${a}, ${e/255})`},ae=(t,e,o,n,a,r,i)=>{let m=t.createLinearGradient(e,o,n,a);return m.addColorStop(0,ne(r)),m.addColorStop(1,ne(i)),m};var ie=(t,e,o,n)=>{let a=V(),r=w(a),i=x[o[0]];a.width=t,a.height=e;let m=ct(t/i.width),s=ct(e/i.height);for(let c=0;c<m;c++)for(let f=0;f<s;f++)i=x[yt(o,n)],r.drawImage(i,c*i.width,f*i.height);return a},se=(t,e,o)=>{let n=V(),a=w(n);n.width=t,n.height=e;let r=x[o],i=ct(t/r.width),m=ct(e/r.height);for(let s=0;s<i;s++)for(let c=0;c<m;c++)a.drawImage(r,s*r.width,c*r.height);return n},me=(t,e)=>{for(let o=0;o<t.length;o+=3){let n=t[o],a=t[o+1],r=t[o+2],i=x[n];H(e,i,a,r)}},_t=(t,e,o,n,a,r,i)=>{t.fillStyle=ae(t,e,o,e,o+a,r,i),t.fillRect(e,o,n,a)};var Ht=(t,e)=>{let o=w(t),n=t.width,a=t.height,r=o.getImageData(0,0,n,a),i=r.data,m=0;for(;m<i.length;){let s=i.slice(m,m+4);e(s),i.set(s,m),m+=4}o.putImageData(r,0,0)},kt=t=>{var e=V(),o=w(e);return e.width=t.width,e.height=t.height,o.drawImage(t,0,0),e};var ce=(t,e,o)=>{Ht(t,n=>{let a=_o(n),r=e.indexOf(a);if(r!=-1){let i=o[r];ko(i,n)}})},re=new Uint32Array(1),_o=t=>{let e=t[0],o=t[1],n=t[2],a=t[3];return re[0]=a<<24|e<<16|o<<8|n,re[0]},ko=(t,e)=>{let o=t>>24&255,n=t>>16&255,a=t>>8&255,r=t&255;e[0]=n,e[1]=a,e[2]=r,e[3]=o};var x=[],At={},dt=t=>{let e=x.length;return x.push(t),e},Z=(t,e)=>{let o=`${t}_${e}`;if(!At[o]){let n=e>>24&255,a=e>>16&255,r=e>>8&255,i=e&255,m=kt(x[t]);Ht(m,s=>{s[0]=a,s[1]=r,s[2]=i,s[3]&&(s[3]=n)}),At[o]=dt(m)}return At[o]},zt=(t,e)=>{let o=w(e),n=t/2,a=o.getImageData(0,0,e.width,e.height),r=a.data,i=0;for(;i<r.length;){let m=r[i],s=r[i+1],c=r[i+2];r[i]=m-n+t*F(),r[i+1]=s-n+t*F(),r[i+2]=c-n+t*F(),i+=4}o.putImageData(a,0,0)};var O;(function(t){t.normalize=e=>{let o=t.length(e);o>0&&(e.x/=o,e.y/=o)},t.length=e=>Rt(e.x,e.y),t.distance=(e,o)=>Rt(e.x-o.x,e.y-o.y),t.add=(e,o)=>({x:e.x+o.x,y:e.y+o.y}),t.subtract=(e,o)=>({x:e.x-o.x,y:e.y-o.y}),t.scale=(e,o)=>({x:e.x*o,y:e.y*o})})(O||(O={}));var gt=xt(),v=0,fe=()=>{let t=gt;gt=xt(),v=(gt-t)/1e3};var tt=t=>{let e=0;for(let o of t)e+=o.time;return e},St=(t,e)=>{let o=0,n=tt(t);e%=n;for(let a=0;a<t.length;a++){let r=t[a];if(o+=r.time,e<=o)return r.image}return 0},ht=(t,e)=>{let o=tt(t);return e>=o};var et=[],pe={animation:[{image:63,time:.1},{image:64,time:.1},{image:65,time:.1}],offset:{x:16,y:16}},le={animation:[{image:66,time:.1},{image:67,time:.2},{image:68,time:.2}],offset:{x:8,y:8}},xe={animation:[{image:69,time:.1},{image:70,time:.2},{image:71,time:.2}],offset:{x:8,y:8}},Po=t=>{let e=et.indexOf(t);e!=-1&&et.splice(e,1)},de=(t,e)=>{et.push({animation:t.animation,animationTime:0,sprite:{image:0,x:e.x-t.offset.x,y:e.y-t.offset.y}})},ge=()=>{for(let t of et){let e=tt(t.animation);t.animationTime+=v,t.animationTime>e?Po(t):t.sprite.image=St(t.animation,t.animationTime)}};var I=[],he=t=>{let e=I.indexOf(t);e!=-1&&I.splice(e,1)},ue=()=>{I.splice(0,I.length)};var Dt,C=()=>Dt,ye=t=>{Dt=t;for(let e of Dt.items)e.sprite.x=e.position.x-e.offset.x,e.sprite.y=e.position.y-e.offset.y,e.shadow&&(e.shadow.x=e.position.x-e.offset.x,e.shadow.y=e.position.y-e.offset.y*e.shadow.scaleY),I.push(e)},be=()=>{let t=C(),e=x[t.back.image];-t.camera.x>0&&(t.camera.x=0),-t.camera.x+e.width<k&&(t.camera.x=e.width-k),-t.camera.y>0&&(t.camera.y=0),-t.camera.y+e.height<T&&(t.camera.y=e.height-T)};var g=[],vt=t=>{let e={config:t,state:0,controller:{move:{x:0,y:0},hand:!1,leg:!1,cross:!1},health:t.health,direction:1,position:{x:0,y:0},speed:{x:0,y:0},animationTime:0,sprite:{image:0},shadow:{image:0},damage:0,frame:0};return g.push(e),I.push(e),e},Bo=t=>{let e=g.indexOf(t);e!=-1&&g.splice(e,1),he(t)},_e=()=>{g.splice(0,g.length)},ke=()=>{let t=C();for(let e of g.values())e.position.x=Pt(t.bounds.x,t.bounds.x+t.bounds.w,e.position.x),e.position.y=Pt(t.bounds.y,t.bounds.y+t.bounds.h,e.position.y)},Se=()=>{for(let t of g.values())Ho(t)},Ho=t=>{let e=null,o=t.config,n=o.animations;switch(t.state){case 0:e=n.stand,(t.controller.move.x!=0||t.controller.move.y!=0)&&(t.state=1,t.animationTime=0),we(t);break;case 1:t.controller.move.x==0&&t.controller.move.y==0?(t.state=0,t.animationTime=0):pt(t.controller.move.x)>pt(t.controller.move.y)?e=n.walkH:e=n.walkV,O.normalize(t.controller.move),t.position.x+=t.controller.move.x*o.walkSpeed*v,t.position.y+=t.controller.move.y*o.walkSpeed*v,we(t);break;case 2:e=n.jab,ht(e,t.animationTime)&&(t.controller.hand?t.state=3:t.state=0,t.animationTime=0);break;case 3:e=n.cross,ht(e,t.animationTime)&&(t.controller.hand||(t.state=0,t.animationTime=0));break;case 4:e=n.kick,ht(e,t.animationTime)&&(t.state=0,t.animationTime=0);break;case 5:e=t.animation||n.damage1,ht(e,t.animationTime)&&(t.state=0,t.animationTime=0,t.animation=void 0);break;case 6:e=t.animation||n.dead1,tt(e)<=t.animationTime+v&&(Bo(t),e=null);break}t.position.x+=t.speed.x*v,t.position.y+=t.speed.y*v,t.speed.x*=.9,t.speed.y*=.9,t.controller.move.x>0?t.direction=1:t.controller.move.x<0&&(t.direction=-1),e&&(t.animationTime+=v,t.sprite.image=St(e,t.animationTime),t.sprite.flipX=t.direction<0,t.shadow.image=Z(t.sprite.image,1426063360),t.shadow.flipX=t.sprite.flipX),t.damage=0,t.frame!=t.sprite.image&&(t.frame=t.sprite.image,t.damage=o.damages[t.frame]||0)},ve=()=>{for(let t of g){if(t.health<=0||!t.damage)continue;let e=null,o=Wt,n=Wt;for(let a of g)if(!(a.health<=0)&&t.config.mob!=a.config.mob){let r=a.position.x-t.position.x;if(r*t.direction>0){let i=pt(r),m=pt(t.position.y-a.position.y);i<25&&m<10&&(!e||o>i||n>m)&&(e=a,o=i,n=m)}}if(e){e.health-=t.damage,e.speed.x+=t.direction*t.damage/100*300,t.speed.x+=t.direction*10;let a=t.damage>=20?pe:Bt(.5)?xe:le;de(a,O.add(e.position,{x:Q(-3,3),y:Q(-14,-18)})),e.health>0?(e.state=5,e.animation!=e.config.animations.knockdown&&(e.animationTime=0),e.animation=lt([e.config.animations.damage1,e.config.animations.damage2,e.config.animations.knockdown])):(e.state=6,e.animation=lt([e.config.animations.dead1,e.config.animations.dead2]),e.animationTime=0)}}},Ce=()=>{for(let t of g.values())Ao(t)},Ao=t=>{let e=t.config;t.sprite.x=t.position.x-e.offset.x,t.sprite.y=t.position.y-e.offset.y,t.shadow.scaleY=.4,t.shadow.x=t.position.x-e.offset.x+0,t.shadow.y=t.position.y-e.offset.y*t.shadow.scaleY},we=t=>{t.controller.leg&&(t.state=4,t.animationTime=0),t.controller.hand&&(t.state=2,t.animationTime=0),t.controller.cross&&(t.state=3,t.animationTime=0)};var _n=()=>{let t=[];return t[33]=61,t[35]=0,t[46]=62,t[47]=-1,t.push(25,26,27,28,29,30,31,32,33,34),t[64]=0,t.push(35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60),t},Ft=_n(),Me=t=>{if(t!=32&&(Ft[t]===void 0||Ft[t]===-1))throw`symbol not found ${t} char ${String.fromCharCode(t)}`;return Ft[t]};var U=(t,e)=>{t.save();let o=x[e.image],n=1,a=0,r=0,i=e.scaleY||1,m=B(e.x||0),s=B(e.y||0);e.flipX&&(n=-1,m+=o.width),e.flipY&&(i=-1,s+=o.height),t.transform(n,a,r,i,m,s),H(t,o,0,0),t.restore()},Ie=(t,e)=>{for(let o of e)U(t,o)};var u=document.getElementById("c");u.style.imageRendering="pixelated";var d=w(u),k=200,T=200,N={x:0,y:0},Te=()=>{let t=window.innerWidth,e=window.innerHeight,o=ft(t/k,e/T);u.width=ut(k,t/o),u.height=ut(T,e/o),u.style.width=`${t}px`,u.style.height=`${e}px`,N.x=Et((u.width-k)/2),N.y=Et((u.height-T)/2)},Ee=()=>{d.clearRect(0,0,u.width,u.height),d.setTransform(1,0,0,1,N.x,N.y);let t=C();d.save(),d.translate(B(-t.camera.x),B(-t.camera.y)),U(d,t.back),d.shadowBlur=2,d.shadowColor="black";for(let e of g)U(d,e.shadow);for(let e of t.items)e.shadow&&U(d,e.shadow);d.shadowBlur=0,I.sort((e,o)=>e.position.y==o.position.y?o.position.x-e.position.x:e.position.y-o.position.y);for(let e of I)U(d,e.sprite);for(let e of et)U(d,e.sprite);d.restore(),d.fillStyle="black",u.width<u.height?(d.fillRect(0,-N.y,k,N.y),d.fillRect(0,T,k,T)):(d.fillRect(-N.x,0,N.x,k),d.fillRect(k,0,k,T)),kn()},kn=()=>{if(!0){let t=(xt()-gt).toFixed(),e=(1/v).toFixed();Sn(3,3,`FPS ${e} TIME ${t}`,2583691263)}},Sn=(t,e,o,n)=>{for(let a=0;a<o.length;a++){let r=o[a].toUpperCase().charCodeAt(0),i=Me(r);if(i!==void 0){let m=Z(i,n),s=x[m];s!==void 0&&H(d,s,t+a*8,e)}}};var Re=(...t)=>{let e=Y.createBufferSource(),o=Y.createBuffer(t.length,t[0].length,S);return t.map((n,a)=>o.getChannelData(a).set(n)),e.buffer=o,e.connect(Y.destination),e.start(),e},vn=(t=1,e=.05,o=220,n=0,a=0,r=.1,i=0,m=1,s=0,c=0,f=0,p=0,h=0,R=0,W=0,z=0,y=0,G=1,X=0,at=0)=>{let b=2*Math.PI,rt=s*=500*b/S**2,it=(0<W?1:-1)*b/4,K=o*=(1+2*e*Math.random()-e)*b/S,L=[],M=0,st=0,l=0,D=1,Tt=0,uo=0,q=0,mt,J;for(n=99+S*n,X*=S,a*=S,r*=S,y*=S,c*=500*b/S**3,W*=b/S,f*=b/S,p*=S,h=S*h|0,J=n+X+a+r+y|0;l<J;L[l++]=q)++uo%(100*z|0)||(q=i?1<i?2<i?3<i?Math.sin((M%b)**3):Math.max(Math.min(Math.tan(M),1),-1):1-(2*M/b%2+2)%2:1-4*Math.abs(Math.round(M/b)-M/b):Math.sin(M),q=(h?1-at+at*Math.sin(2*Math.PI*l/h):1)*(0<q?1:-1)*Math.abs(q)**m*t*Cn*(l<n?l/n:l<n+X?1-(l-n)/X*(1-G):l<n+X+a?G:l<J-y?(J-l-y)/r*G:0),q=y?q/2+(y>l?0:(l<J-y?1:(J-l)/y)*L[l-y|0]/2):q),mt=(o+=s+=c)*Math.sin(st*W-it),M+=mt-mt*R*(1-1e9*(Math.sin(l)+1)%2),st+=mt-mt*R*(1-1e9*(Math.sin(l)**2+1)%2),D&&++D>p&&(o+=f,K+=f,D=0),!h||++Tt%h||(o=K,s=rt,D=D||1);return L},Cn=.3,S=44100,Y=new(window.AudioContext||webkitAudioContext),We=(t,e,o,n=125)=>{let a,r,i,m,s,c,f,p,h,R,W,z,y,G,X=0,at,b=[],rt=[],it=[],K=0,L=0,M=1,st={},l=44100/n*60>>2;for(;M;K++)b=[M=p=W=y=0],o.map((D,Tt)=>{for(f=e[D][K]||[0,0,0],M|=!!e[D][K],at=y+(e[D][0].length-2-!p)*l,G=Tt==o.length-1,r=2,m=y;r<f.length+G;p=++r){for(s=f[r],h=r==f.length+G-1&&G||R!=(f[0]||0)|s|0,i=0;i<l&&p;i++>l-99&&h?z+=(z<1)/99:0)c=(1-z)*b[X++]/2||0,rt[m]=(rt[m]||0)-c*L+c,it[m]=(it[m++]||0)+c*L+c;s&&(z=s%1,L=f[1]||0,(s|=0)&&(b=st[[R=f[X=0]||0,s]]=st[[R,s]]||(a=[...t[R]],a[2]=(a[2]||220)*2**((s-12)/12),s>0?vn(...a):[])))}y=at});return[rt,it]};var Ct=(t=!1)=>{(t||Y.state==="suspended")&&Y.resume().catch()},Pe=async t=>{let e=await Mn(t),o=Re(...e);o.loop=!0,Y.resume()},Mn=async t=>(await oe(50),We(...t));var Ot={},Be=!1,He=()=>{bt.onkeydown=t=>{Ct(),Be=!0,Ot[t.keyCode]=!0,t.preventDefault()},bt.onkeyup=t=>{Be=!1,In(t.keyCode),t.preventDefault()},u.onmousedown=()=>{Ct()},u.ontouchstart=()=>{Ct()}},E=t=>Ot[t],In=t=>delete Ot[t];var Bn={mob:!1,health:1e3,walkSpeed:30,offset:{x:16,y:29},animations:{stand:[{image:72,time:.2},{image:73,time:.2},{image:74,time:.2},{image:73,time:.2},{image:72,time:.2},{image:75,time:.2}],walkH:[{image:72,time:.1},{image:76,time:.1},{image:77,time:.1},{image:76,time:.1}],walkV:[{image:83,time:.1},{image:84,time:.1},{image:83,time:.1},{image:85,time:.1}],jab:[{image:72,time:.05},{image:80,time:.1}],cross:[{image:80,time:.1},{image:81,time:.1},{image:82,time:.1},{image:81,time:.1}],kick:[{image:72,time:.05},{image:78,time:.05},{image:79,time:.1},{image:78,time:.1}],damage1:[{image:72,time:1}],damage2:[{image:72,time:1}],knockdown:[{image:72,time:1}],dead1:[{image:72,time:1}],dead2:[{image:72,time:1}]},damages:{80:10,82:20,79:30}},_,Xe=()=>{_=vt(Bn)},ot=()=>_,qe=()=>{_&&(_.health<=0||(_.controller.move.x=0,_.controller.move.y=0,_.controller.leg=!1,_.controller.hand=!1,(E(37)||E(65))&&(_.controller.move.x=-1),(E(39)||E(68))&&(_.controller.move.x=1),(E(38)||E(87))&&(_.controller.move.y=-1),(E(40)||E(83))&&(_.controller.move.y=1),E(90)&&(_.controller.leg=!0),E(88)&&(_.controller.hand=!0)))};var Wr=1*(Math.exp(.5)-1);var Ne,Ye=[];Jt||Hn();function Hn(){Ne||(Ne=new AudioContext,console.log("sound inited"))}async function $e(){let e=await(await fetch("r")).arrayBuffer(),o=new Uint8Array(e),n=0,a=o[n++]*4,r=o.slice(n,n+a);n+=a;let i=o[n++];for(;i--;){let s=o[n++],c=o[n++],f=s*c,p=o.slice(n,n+f);n+=f;let h=Qt();Zt(h,s),te(h,c);let R=h.getImageData(0,0,s,c);for(let W=0;W<p.length;W++){let z=p[W]<<2;R.data.set(r.slice(z,z+4),W<<2)}h.putImageData(R,0,0),x.push(wt(h))}let m=o[n++];for(;m--;){let s=o[n++];Ye.push(e.slice(n,n+s)),n+=s}}var Le=[[[.6,0,100,,,.2,1,.5,,-10,,,,3,,,,10],[.7,0,110,,,.2,2,.1,,,,,,,,,,,.1,.4],[1.3,0,300,,,0,4,3,,,300,,,1,,,,.3,.2],[,0,,,.13,.7,2,.2,,,,,.04,.3,,.02,1,,.3,.1],[3,0,60,,,,3,.2,,,,.5,,.6,1,.05],[,0],[,0]],[[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,3,,15,,3,,15,,],[3,.3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,1,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,4,,16,16,4,,16,16,4,,16,,4,,16,16,4,,16,16,4,,16,16,3,,15,15,3,,15,15],[3,.4,,,,,20,,,,,,23,,,,,,25,,,,,,27,,,,,,25,,,,27,,,,,,,,,,,,,,,,28,,27,,,,25,,,,27,,,,25,,]]],[0,0,1,1],,];var Mt=[],Yn=[4278190080,4294939392,4287898002,4289362242,4284354049,4290735454,4278215936,4278217323,4278261885],$n={mob:!0,health:100,walkSpeed:20,offset:{x:16,y:31},animations:{stand:[{image:87,time:.3},{image:88,time:.3},{image:87,time:.3},{image:89,time:.3},{image:90,time:.3},{image:89,time:.3}],walkH:[{image:87,time:.2},{image:91,time:.2},{image:87,time:.2},{image:92,time:.2}],walkV:[{image:87,time:.2},{image:96,time:.2},{image:87,time:.2},{image:97,time:.2}],jab:[{image:87,time:.2},{image:93,time:.2}],cross:[{image:93,time:.2},{image:94,time:.2},{image:95,time:.2},{image:94,time:.2}],kick:[{image:87,time:.2},{image:98,time:.2},{image:99,time:.2},{image:98,time:.2}],damage1:[{image:101,time:.5},{image:100,time:.3}],damage2:[{image:105,time:.5},{image:104,time:.3}],knockdown:[{image:100,time:.2},{image:101,time:.5},{image:102,time:1},{image:103,time:.3},{image:104,time:.2}],dead1:[{image:105,time:.2},{image:106,time:.2},{image:107,time:.2},{image:108,time:5}],dead2:[{image:100,time:.2},{image:101,time:.5},{image:102,time:1}]},damages:{93:5,95:10,99:20}},Yt=[],no=()=>{Yt.push(oo([4278190080,4294939392,4281545523,4281545523,4288256409,4294939392,4278190131,4278190131,4278190080],"bob")),Yt.push(oo([4278190080,4294939392,4285642965,4294939392,4294939392,4278190080,4286151563,4286151563,4278190080],"jack"))},oo=(t,e)=>{let o=ee($n);o.walkSpeed=Q(10,20);let n=o.animations;for(let a in n){let r=n[a];Ln(r,Yn,t,e)}return o},Ln=(t,e,o,n)=>{for(let a of t)a.image=Vn(a.image,e,o,n)},Nt={},Vn=(t,e,o,n)=>{let a=`${t}_${n}`;if(!Nt[a]){let r=kt(x[t]);ce(r,e,o),Nt[a]=dt(r)}return Nt[a]},$t=t=>{let e=vt(Yt[t]);return Mt.push(e),e};var jn=t=>{let e=Mt.indexOf(t);e!=-1&&Mt.splice(e,1)},ao=()=>{let t=ot();for(let e of Mt)Kn(e,t)},Kn=(t,e)=>{if(g.indexOf(t)==-1&&jn(t),t.health<=0)return;t.controller.move.x=0,t.controller.move.y=0,t.controller.leg=!1,t.controller.hand=!1,t.controller.cross=!1;let o=15;if(t.state==0||t.state==1){let n=O.subtract(e.position,t.position);if(O.length(n)>o)O.normalize(n),t.controller.move.x=n.x,t.controller.move.y=n.y;else{t.controller.move.x=0,t.controller.move.y=0;let r=F();r<.5?t.controller.hand=!0:r<.8?t.controller.cross=!0:t.controller.leg=!0}}};var po=()=>{let n=pa(400,150),a=la(400,95),r=V(),i=w(r);r.width=400,r.height=245,H(i,a,0,0),H(i,n,0,95);let m=dt(r),s=10,c=5,f=[];for(let p=0;p<10;p++)Vt(f,90+p*21,120);Vt(f,84,114),Vt(f,273,114);for(let p=0;p<10;p++)fa(f,100+p*20,130);return{bounds:{x:s,y:95+c,w:400-s*2,h:150-c*2},back:{image:m},camera:{x:0,y:0},items:f}},Vt=(t,e,o)=>{t.push({sprite:{image:6},position:{x:e,y:o},offset:{x:16,y:32},bounds:{x:-16,y:-10,w:32,h:12}})},fa=(t,e,o)=>{t.push({sprite:{image:7},position:{x:e,y:o},offset:{x:16,y:32},bounds:{x:-6,y:-7,w:12,h:10},shadow:{image:Z(7,1426063360),scaleY:.4}})},pa=(t,e)=>{let o=ie(t,e,[2,3,4,5],[3,2,1,1]),n=w(o),a=30;return n.fillStyle="black",n.fillRect(0,0,o.width,1),_t(n,0,0,o.width,a,1996488704,0),_t(n,0,o.height-a,o.width,a,0,1996488704),zt(10,o),o},la=(t,e)=>{let o=se(t,e,8),n=w(o),a=[9,10,11],r=[2,1,1],i=70;for(let s=0;s<t;s+=i)for(let c=0;c<t;c+=16){let f=x[yt(a,r)];H(n,f,s,c)}me([12,i-13,0,12,i*3-13,0,12,i*6-13,0,13,i*2-17,0,13,i*5-30,0],n),Kt(n,89,30),Kt(n,159,30),Kt(n,229,30);let m=40;return _t(n,0,o.height-m,o.width,m,0,1996488704),zt(10,o),o},jt=(t,e,o,n)=>{for(let a=0;a<6;a++){let r=lt(e);U(t,{image:r,x:a*7+o,y:n})}};function Kt(t,e,o){t.setTransform(1,0,0,1,e,o),Ie(t,[{image:14},{image:15,y:16},{image:14,y:32,flipY:!0},{image:16,x:16},{image:14,x:32,flipX:!0},{image:15,x:32,y:16,flipX:!0},{image:14,x:32,y:32,flipY:!0,flipX:!0},{image:17,x:16,y:16},{image:16,x:16,y:32,flipY:!0},{image:18,x:3,y:15},{image:18,x:16,y:15},{image:18,x:29,y:15},{image:18,x:3,y:30},{image:18,x:16,y:30},{image:18,x:29,y:30}]),jt(t,[19,20,21],-1,-1),jt(t,[21,22,20],-1,14),jt(t,[23],-1,28),t.resetTransform()}var lo=()=>{_e(),ue(),ye(po()),Xe();let t=C(),e=$t(0);e.position.x=t.bounds.x+100,e.position.y=t.bounds.y+t.bounds.h/2;let o=$t(1);o.position.x=t.bounds.x+120,o.position.y=t.bounds.y+t.bounds.h/2+20;let n=ot();n.position.x=t.bounds.x+250,n.position.y=t.bounds.y+30};var xo=()=>{let t=C(),e=ot();t.camera.x=e.position.x-k/2,t.camera.y=e.position.y-T/2};var go=()=>{let t=C();for(let e of g)for(let o of t.items){let n=o.position.x+o.bounds.x,a=o.position.y+o.bounds.y,r=n+o.bounds.w,i=a+o.bounds.h,m=e.position.x-n,s=e.position.y-a,c=r-e.position.x,f=i-e.position.y;if(m>0&&s>0&&c>0&&f>0){let p=ft(m,s,c,f);m==p&&(e.position.x-=m),s==p&&(e.position.y-=s),c==p&&(e.position.x+=c),f==p&&(e.position.y+=f)}}};console.warn("debug mode"),new EventSource("/esbuild").addEventListener("change",()=>location.reload());var ho=()=>{fe(),Te(),qe(),ao(),Se(),go(),ve(),ke(),ge(),xo(),be(),Ce(),Ee(),requestAnimationFrame(ho)};async function xa(){await $e(),Pe(Le),He(),no(),lo(),ho()}xa();})();
//# sourceMappingURL=s.js.map

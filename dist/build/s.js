"use strict";(()=>{var a=Math,ce=a.floor,m=a.round,D=a.min,E=a.max,pe=a.hypot,fe=a.abs,me=a.random,le=a.atan2,pt=a.PI,de=pt*2;var S=document,G="ontouchstart"in window;var ft="canvas",R=t=>t.getContext("2d"),mt=()=>S.createElement(ft),H=()=>R(mt()),k=t=>t.canvas;var L=(t,e)=>k(t).width=e,V=(t,e)=>k(t).height=e;var O=(t,e,o,n)=>t.drawImage(e,m(o),m(n));var h=()=>performance.now();var P={},W=!1,z=()=>{S.onkeydown=t=>{W=!0,P[t.keyCode]=!0,t.preventDefault()},S.onkeyup=t=>{W=!1,lt(t.keyCode),t.preventDefault()}},l=t=>P[t],lt=t=>delete P[t];var _=h(),d=0,$=()=>{let t=_;_=h(),d=(_-t)/1e3};var K=t=>{let e=0;for(let o of t)e+=o.time;return e},j=(t,e)=>{let o=0,n=K(t);e%=n;for(let r=0;r<t.length;r++){let p=t[r];if(o+=p.time,e<=o)return p.image}return 0},J=(t,e)=>{let o=K(t);return e>=o};var b=[],Q=t=>{let e={config:t,state:0,controller:{move:{x:0,y:0},hand:!1,leg:!1},health:0,position:{x:0,y:0},animationTime:0,image:0};return b.push(e),e};var X=()=>{for(let t of b.values()){let e=null,o=t.config,n=o.animations;switch(t.state){case 0:e=n.stand,t.controller.move.x!=0&&(t.state=1,t.animationTime=0),t.controller.leg&&(t.state=4,t.animationTime=0);break;case 1:e=n.walk,t.controller.move.x==0&&(t.state=0,t.animationTime=0);break;case 2:e=n.jab;break;case 3:e=n.cross;break;case 4:e=n.kick,J(e,t.animationTime)&&(t.state=0,t.animationTime=0);break}t.position.x+=t.controller.move.x*o.walkSpeed*d,e&&(t.animationTime+=d,t.image=j(e,t.animationTime))}};var _t={walkSpeed:30,animations:{stand:[{image:38,time:.2},{image:39,time:.2},{image:40,time:.2},{image:39,time:.2},{image:38,time:.2},{image:41,time:.2}],walk:[{image:38,time:.1},{image:42,time:.1},{image:43,time:.1},{image:42,time:.1}],jab:[],cross:[],kick:[{image:38,time:.1},{image:44,time:.1},{image:45,time:.1},{image:44,time:.1}]}},i=Q(_t);i.position.y=100;i.position.x=100;var et=()=>{i.controller.move.x=0,i.controller.leg=!1,(l(37)||l(65))&&(i.controller.move.x=-1),(l(39)||l(68))&&(i.controller.move.x=1),l(38)&&(i.controller.leg=!0)};var oe=()=>{let t=[];return t[33]=36,t[35]=0,t[46]=37,t[47]=-1,t.push(0,1,2,3,4,5,6,7,8,9),t[64]=0,t.push(10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35),t},B=oe(),ot=t=>{if(!1)throw`symbol not found ${t} char ${String.fromCharCode(t)}`;return B[t]};var g=[];var s=document.getElementById("c");s.style.imageRendering="pixelated";var x=R(s),C=200,I=200,T={x:0,y:0},nt=()=>{let t=window.innerWidth,e=window.innerHeight,o=D(t/C,e/I);s.width=E(C,t/o),s.height=E(I,e/o),s.style.width=`${t}px`,s.style.height=`${e}px`,T.x=m((s.width-C)/2),T.y=m((s.height-I)/2)},rt=()=>{x.clearRect(0,0,s.width,s.height),x.setTransform(1,0,0,1,T.x,T.y),x.fillStyle="gray",x.fillRect(0,0,C,I);for(let t of b.values()){let e=g[t.image];O(x,e,t.position.x,t.position.y)}ne()},ne=()=>{if(!1){let t=(h()-_).toFixed(),e=(1/d).toFixed();re(3,3,`FPS ${e} TIME ${t}`,16777215)}},re=(t,e,o,n)=>{for(let r=0;r<o.length;r++){let p=o[r].toUpperCase().charCodeAt(0),y=ot(p);if(y!==void 0){let w=g[y];w!==void 0&&O(x,w,t+r*8,e)}}};var Le=1*(Math.exp(.5)-1);var st,at=[];G||se();function se(){st||(st=new AudioContext,!1)}async function it(){let e=await(await fetch("r")).arrayBuffer(),o=new Uint8Array(e),n=0,r=o[n++]*4,p=o.slice(n,n+r);n+=r;let y=o[n++];for(;y--;){let f=o[n++],A=o[n++],F=f*A,q=o.slice(n,n+F);n+=F;let u=H();L(u,f),V(u,A);let N=u.getImageData(0,0,f,A);for(let v=0;v<q.length;v++){let U=q[v]<<2;N.data.set(p.slice(U,U+4),v<<2)}u.putImageData(N,0,0),g.push(k(u))}let w=o[n++];for(;w--;){let f=o[n++];at.push(e.slice(n,n+f)),n+=f}}!1;var ct=()=>{$(),nt(),et(),X(),rt(),requestAnimationFrame(ct)};async function ae(){await it(),z(),ct()}ae();})();
//# sourceMappingURL=s.js.map

"use strict";(()=>{var v=Math,qe=v.floor,R=v.round,at=v.min,tt=v.max,De=v.hypot,Ne=v.abs,Ue=v.random,Ge=v.atan2,Ot=v.PI,He=Ot*2;var W=document,st="ontouchstart"in window;var Ft="canvas",et=t=>t.getContext("2d"),qt=()=>W.createElement(Ft),it=()=>et(qt()),$=t=>t.canvas;var ft=(t,e)=>$(t).width=e,ct=(t,e)=>$(t).height=e;var ot=(t,e,o,n)=>t.drawImage(e,R(o),R(n));var H=()=>performance.now();async function pt(t){return new Promise(e=>{setTimeout(e,t)})}var L=H(),B=0,lt=()=>{let t=L;L=H(),B=(L-t)/1e3};var mt=t=>{let e=0;for(let o of t)e+=o.time;return e},ut=(t,e)=>{let o=0,n=mt(t);e%=n;for(let r=0;r<t.length;r++){let i=t[r];if(o+=i.time,e<=o)return i.image}return 0},dt=(t,e)=>{let o=mt(t);return e>=o};var K=[],xt=t=>{let e={config:t,state:0,controller:{move:{x:0,y:0},hand:!1,leg:!1},health:0,position:{x:0,y:0},animationTime:0,image:0};return K.push(e),e};var ht=()=>{for(let t of K.values()){let e=null,o=t.config,n=o.animations;switch(t.state){case 0:e=n.stand,t.controller.move.x!=0&&(t.state=1,t.animationTime=0),t.controller.leg&&(t.state=4,t.animationTime=0);break;case 1:e=n.walk,t.controller.move.x==0&&(t.state=0,t.animationTime=0);break;case 2:e=n.jab;break;case 3:e=n.cross;break;case 4:e=n.kick,dt(e,t.animationTime)&&(t.state=0,t.animationTime=0);break}t.position.x+=t.controller.move.x*o.walkSpeed*B,e&&(t.animationTime+=B,t.image=ut(e,t.animationTime))}};var Me=()=>{let t=[];return t[33]=36,t[35]=0,t[46]=37,t[47]=-1,t.push(0,1,2,3,4,5,6,7,8,9),t[64]=0,t.push(10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35),t},nt=Me(),gt=t=>{if(!1)throw`symbol not found ${t} char ${String.fromCharCode(t)}`;return nt[t]};var V=[];var u=document.getElementById("c");u.style.imageRendering="pixelated";var O=et(u),j=200,J=200,X={x:0,y:0},_t=()=>{let t=window.innerWidth,e=window.innerHeight,o=at(t/j,e/J);u.width=tt(j,t/o),u.height=tt(J,e/o),u.style.width=`${t}px`,u.style.height=`${e}px`,X.x=R((u.width-j)/2),X.y=R((u.height-J)/2)},wt=()=>{O.clearRect(0,0,u.width,u.height),O.setTransform(1,0,0,1,X.x,X.y),O.fillStyle="gray",O.fillRect(0,0,j,J);for(let t of K.values()){let e=V[t.image];ot(O,e,t.position.x,t.position.y)}ve()},ve=()=>{if(!1){let t=(H()-L).toFixed(),e=(1/B).toFixed();ke(3,3,`FPS ${e} TIME ${t}`,16777215)}},ke=(t,e,o,n)=>{for(let r=0;r<o.length;r++){let i=o[r].toUpperCase().charCodeAt(0),m=gt(i);if(m!==void 0){let x=V[m];x!==void 0&&ot(O,x,t+r*8,e)}}};var yt=(...t)=>{let e=z.createBufferSource(),o=z.createBuffer(t.length,t[0].length,d);return t.map((n,r)=>o.getChannelData(r).set(n)),e.buffer=o,e.connect(z.destination),e.start(),e},be=(t=1,e=.05,o=220,n=0,r=0,i=.1,m=0,x=1,a=0,h=0,c=0,_=0,f=0,w=0,y=0,S=0,p=0,k=1,b=0,q=0)=>{let l=2*Math.PI,D=a*=500*l/d**2,N=(0<y?1:-1)*l/4,T=o*=(1+2*e*Math.random()-e)*l/d,I=[],g=0,U=0,s=0,M=1,Y=0,Bt=0,C=0,G,P;for(n=99+d*n,b*=d,r*=d,i*=d,p*=d,h*=500*l/d**3,y*=l/d,c*=l/d,_*=d,f=d*f|0,P=n+b+r+i+p|0;s<P;I[s++]=C)++Bt%(100*S|0)||(C=m?1<m?2<m?3<m?Math.sin((g%l)**3):Math.max(Math.min(Math.tan(g),1),-1):1-(2*g/l%2+2)%2:1-4*Math.abs(Math.round(g/l)-g/l):Math.sin(g),C=(f?1-q+q*Math.sin(2*Math.PI*s/f):1)*(0<C?1:-1)*Math.abs(C)**x*t*Ce*(s<n?s/n:s<n+b?1-(s-n)/b*(1-k):s<n+b+r?k:s<P-p?(P-s-p)/i*k:0),C=p?C/2+(p>s?0:(s<P-p?1:(P-s)/p)*I[s-p|0]/2):C),G=(o+=a+=h)*Math.sin(U*y-N),g+=G-G*w*(1-1e9*(Math.sin(s)+1)%2),U+=G-G*w*(1-1e9*(Math.sin(s)**2+1)%2),M&&++M>_&&(o+=c,T+=c,M=0),!f||++Y%f||(o=T,a=D,M=M||1);return I},Ce=.3,d=44100,z=new(window.AudioContext||webkitAudioContext),St=(t,e,o,n=125)=>{let r,i,m,x,a,h,c,_,f,w,y,S,p,k,b=0,q,l=[],D=[],N=[],T=0,I=0,g=1,U={},s=44100/n*60>>2;for(;g;T++)l=[g=_=y=p=0],o.map((M,Y)=>{for(c=e[M][T]||[0,0,0],g|=!!e[M][T],q=p+(e[M][0].length-2-!_)*s,k=Y==o.length-1,i=2,x=p;i<c.length+k;_=++i){for(a=c[i],f=i==c.length+k-1&&k||w!=(c[0]||0)|a|0,m=0;m<s&&_;m++>s-99&&f?S+=(S<1)/99:0)h=(1-S)*l[b++]/2||0,D[x]=(D[x]||0)-h*I+h,N[x]=(N[x++]||0)+h*I+h;a&&(S=a%1,I=c[1]||0,(a|=0)&&(l=U[[w=c[b=0]||0,a]]=U[[w,a]]||(r=[...t[w]],r[2]=(r[2]||220)*2**((a-12)/12),a>0?be(...r):[])))}p=q});return[D,N]};var Q=(t=!1)=>{(t||z.state==="suspended")&&z.resume().catch()},Mt=async t=>{let e=await ze(t),o=yt(...e);o.loop=!0,z.resume()},ze=async t=>(await pt(50),St(...t));var rt={},vt=!1,kt=()=>{W.onkeydown=t=>{Q(),vt=!0,rt[t.keyCode]=!0,t.preventDefault()},W.onkeyup=t=>{vt=!1,Ie(t.keyCode),t.preventDefault()},u.onmousedown=()=>{Q()},u.ontouchstart=()=>{Q()}},F=t=>rt[t],Ie=t=>delete rt[t];var Re={walkSpeed:30,animations:{stand:[{image:38,time:.2},{image:39,time:.2},{image:40,time:.2},{image:39,time:.2},{image:38,time:.2},{image:41,time:.2}],walk:[{image:38,time:.1},{image:42,time:.1},{image:43,time:.1},{image:42,time:.1}],jab:[],cross:[],kick:[{image:38,time:.1},{image:44,time:.1},{image:45,time:.1},{image:44,time:.1}]}},E=xt(Re);E.position.y=100;E.position.x=100;var It=()=>{E.controller.move.x=0,E.controller.leg=!1,(F(37)||F(65))&&(E.controller.move.x=-1),(F(39)||F(68))&&(E.controller.move.x=1),F(38)&&(E.controller.leg=!0)};var ko=1*(Math.exp(.5)-1);var At,Et=[];st||Be();function Be(){At||(At=new AudioContext,!1)}async function Tt(){let e=await(await fetch("r")).arrayBuffer(),o=new Uint8Array(e),n=0,r=o[n++]*4,i=o.slice(n,n+r);n+=r;let m=o[n++];for(;m--;){let a=o[n++],h=o[n++],c=a*h,_=o.slice(n,n+c);n+=c;let f=it();ft(f,a),ct(f,h);let w=f.getImageData(0,0,a,h);for(let y=0;y<_.length;y++){let S=_[y]<<2;w.data.set(i.slice(S,S+4),y<<2)}f.putImageData(w,0,0),V.push($(f))}let x=o[n++];for(;x--;){let a=o[n++];Et.push(e.slice(n,n+a)),n+=a}}var Pt=[[[.6,0,100,,,.2,1,.5,,-10,,,,3,,,,10],[.7,0,110,,,.2,2,.1,,,,,,,,,,,.1,.4],[1.3,0,300,,,0,4,3,,,300,,,1,,,,.3,.2],[,0,,,.13,.7,2,.2,,,,,.04,.3,,.02,1,,.3,.1],[3,0,60,,,,3,.2,,,,.5,,.6,1,.05],[,0],[,0]],[[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,1,,13,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,4,,16,,3,,15,,3,,15,,],[3,.3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,-.1,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,1,,,,],[2,.1,1,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,,1,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,1,,1,1],[1,.1,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,1,,13,,1,,13,13,1,,13,13,4,,16,16,4,,16,16,4,,16,,4,,16,16,4,,16,16,4,,16,16,3,,15,15,3,,15,15],[3,.4,,,,,20,,,,,,23,,,,,,25,,,,,,27,,,,,,25,,,,27,,,,,,,,,,,,,,,,28,,27,,,,25,,,,27,,,,25,,]]],[0,0,1,1],,];!1;var Rt=()=>{lt(),_t(),It(),ht(),wt(),requestAnimationFrame(Rt)};async function Oe(){await Tt(),Mt(Pt),kt(),Rt()}Oe();})();
//# sourceMappingURL=s.js.map
